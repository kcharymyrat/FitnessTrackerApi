<div class="step-text">
<p></p><h5 id="description">Description</h5><p>The first version of the API is ready, so it's time to consider the client applications. Since we're creating a public API, we won't make any client applications ourselves. Instead, we'll allow all developers to make whatever applications they like, such as web, mobile, desktop, IoT or any other kind, that can utilize our API.</p><p>We also aim to monitor these applications, for instance, to set different service levels for free and premium clients in future. Here's the plan: we let developers sign up, register their applications with our service, and then we'll implement an authentication process to ensure the <code class="language-java">/api/tracker</code> endpoints are accessible to registered applications only.</p><p>Now, let's begin with the developer sign-up process.</p><p>To activate Spring Security in the project, add the <code class="language-java">spring-boot-starter-security</code> starter to the <code class="language-java">dependencies</code> section of the <code class="language-java">build.gradle</code> file.</p><p>Create two new endpoints: <code class="language-java">POST /api/developers/signup</code> for new developer registration and <code class="language-java">GET /api/developers/&lt;id&gt;</code> for accessing the profile of the appropriate developer. Use <strong>basic HTTP authentication</strong> for this endpoint.</p><p>The <code class="language-java">POST /api/developers/signup</code> endpoint should accept a JSON request body with two fields, <code class="language-java">email</code> and <code class="language-java">password</code>. As registration data is vital, you need to validate the input to ensure both fields meet the requirements. If the email isn't null, matches the email pattern and is unique, and if the password isn't null and not blank, the service should return the status code <code class="language-java">201 CREATED</code> and the response header <code class="language-java">Location</code> containing the URL of the newly created developer. If either field isn't valid, including if a developer with the submitted email address is already registered, the service should return the status code <code class="language-java">400 BAD REQUEST</code>. You might find the <code class="language-java">spring-boot-starter-validation</code> starter useful for this purpose.</p><p>The <code class="language-java">GET /api/developers/&lt;id&gt;</code> endpoint should be accessible only to the authenticated developer with the matching id. If access is granted, the endpoint should return the status code <code class="language-java">200 OK</code> and a response body in JSON format, containing the id and the email of the corresponding developer. If an unauthenticated developer tries to access this endpoint, it should respond with the status code <code class="language-java">401 UNAUTHORIZED</code>. If an authenticated client tries to access the endpoint but their id doesn't match the id in the request path, the service should respond with the status code <code class="language-java">403 FORBIDDEN</code>.</p><p>At this stage, don't limit access to the <code class="language-java">/api/tracker</code> endpoints, they should be accessible by all.</p><p>Also, when setting up access rules for the API, ensure the <code class="language-java">/actuator/shutdown</code> endpoint remains accessible, or else some tests may not pass. As we're building a REST API, don't use sessions. Plus, if you're using tools like Postman and H2 console, remember to add the necessary methods to the security filter chain configuration:</p><pre><code class="language-java">// other methods
.csrf(csrf -&gt; csrf.disable()) // For Postman
.headers(headers -&gt; headers.frameOptions().disable()) // For the H2 console
.authorizeHttpRequests(auth -&gt; auth
        .requestMatchers("/actuator/shutdown").permitAll() // for tests
        .requestMatchers("/error").permitAll() // to prevent access errors for validation exceptions
        // other matchers
)
.sessionManagement(sessions -&gt; sessions
        .sessionCreationPolicy(SessionCreationPolicy.STATELESS) // no session
)
// other methods</code></pre><h5 id="objectives">Objectives</h5><ul><li><p>Activate Spring Security in the project.</p></li><li><p>Add the <code class="language-java">POST /api/developers/signup</code> endpoint that should be accessible to all users. The endpoint should accept a JSON response body with an email address and a password for a new developer. The email must be unique, not null and match the email pattern. The password must be not null and not blank:</p><pre><code class="language-json">{
  "email": &lt;string, unique, not null, matches the email pattern&gt;,
  "password": &lt;string, not null, not blank&gt;
}</code></pre><p>If the request body is valid, the endpoint should respond with the status code <code class="language-java">201 CREATED</code> and the response header <code class="language-java">Location</code> showing the URL of the created developer:</p><pre><code class="language-no-highlight">Location: /api/developers/&lt;id&gt;</code></pre><p>If any of the request body fields fail to meet the requirements, the endpoint should respond with the status code <code class="language-java">400 BAD REQUEST</code>.</p></li><li><p>Add the <code class="language-java">GET /api/developers/&lt;id&gt;</code> endpoint to return the profile of the corresponding developer as a JSON object:</p><pre><code class="language-json">{
  "id": &lt;id&gt;,
  "email": &lt;string&gt;
}</code></pre><p>This endpoint should be accessible only by the authenticated developer with the same id as in the request path. In case the request is made by an unauthenticated client, the endpoint should respond with the status code <code class="language-java">401 UNAUTHORIZED</code>. If the request is made by an authenticated developer but their id doesn't match the id in the request path, the endpoint should respond with the status code <code class="language-java">403 FORBIDDEN</code>.</p></li><li><p>Save all registered developer data in the database.</p></li><li><p>The <code class="language-java">/api/tracker</code> endpoints should be open to all.</p></li></ul><h5 id="examples">Examples</h5><p><strong>Example 1.</strong> <em>POST request to the /api/developers/signup endpoint</em>:</p><p><em>Request body</em>:</p><pre><code class="language-json">{
  "email": "johndoe@gmail.com",
  "password": "qwerty"
}</code></pre><p><em>Response code</em>: <code class="language-java">201 CREATED</code></p><p><em>Response header</em>:</p><pre><code class="language-no-highlight">Location: /api/developers/9062</code></pre><p><strong>Example 2.</strong> <em>POST request to the /api/developers/signup endpoint lacking a password</em>:</p><p><em>Request body</em>:</p><pre><code class="language-json">{
  "email": "johndoe@gmail.com"
}</code></pre><p><em>Response code</em>: <code class="language-java">400 BAD REQUEST</code></p><p><strong>Example 3.</strong> <em>POST request to the /api/developers/signup endpoint with an email already registered</em>:</p><p><em>Request body</em>:</p><pre><code class="language-json">{
  "email": "johndoe@gmail.com",
  "password": "qwerty"
}</code></pre><p><em>Response code</em>: <code class="language-java">400 BAD REQUEST</code></p><p><strong>Example 4.</strong> <em>GET request to the /api/developers/9062 with login=johndoe@gmail.com and password=qwerty</em>:</p><p><em>Response code</em>: <code class="language-java">200 OK</code></p><p><em>Response body</em>:</p><pre><code class="language-json">{
  "id": 9062,
  "email": "johndoe@gmail.com"
}</code></pre><p><strong>Example 4.</strong> <em>GET request to the /api/developers/0165 with login=johndoe@gmail.com and password=querty</em>:</p><p><em>Response code</em>: <code class="language-java">403 FORBIDDEN</code></p>
</div>